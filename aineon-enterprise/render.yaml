# AINEON SIMPLE RENDER DEPLOYMENT
# Single Python service for immediate deployment
# Architecture: Gasless/ERC/PILMICO + Three-Tier Bot System (simplified)

services:
  # ============================================================================
  # AINEON MAIN ENGINE - Single Service Deployment
  # ============================================================================
  - type: web
    name: aineon-main-engine
    env: python
    plan: pro
    pythonVersion: 3.11.8
    buildCommand: |
      pip install --upgrade pip setuptools wheel
      pip install -r requirements.txt
      pip install web3 eth-account aiohttp asyncio-throttle prometheus-client
    startCommand: python render_deployment_phase1_corrected.py
    envVars:
      # Core System Configuration
      - key: PYTHON_VERSION
        value: "3.11.8"
      - key: ENVIRONMENT
        value: "production"
      - key: LOG_LEVEL
        value: "INFO"
      - key: TARGET_DAILY_PROFIT_ETH
        value: "100.0"
      - key: MANUAL_WITHDRAWAL_THRESHOLD
        value: "5.0"
      - key: AUTO_WITHDRAWAL_ENABLED
        value: "false"
      
      # Gasless/ERC/PILMICO Configuration
      - key: GASLESS_MODE_ENABLED
        value: "true"
      - key: ERC4337_ENABLED
        value: "true"
      - key: ENTRY_POINT
        value: "0x5FF137D4b0FDCD49DcA30c7B27e6a392b0d7Bzz"
      - key: PAYMASTER_BALANCE_MONITORING
        value: "true"
      
      # Three-Tier Bot System Configuration
      - key: THREE_TIER_BOT_ENABLED
        value: "true"
      - key: TIER_1_SCANNERS_ENABLED
        value: "true"
      - key: TIER_2_ORCHESTRATORS_ENABLED
        value: "true"
      - key: TIER_3_EXECUTORS_ENABLED
        value: "true"
      - key: COORDINATION_LATENCY_TARGET_MS
        value: "10"
      
      # Flash Loan System Configuration
      - key: FLASH_LOAN_ENABLED
        value: "true"
      - key: FLASH_LOAN_CAPACITY_USD
        value: "165000000"
      - key: CONCURRENT_FLASH_LOANS
        value: "6"
      
      # AI Optimizer Configuration
      - key: AI_OPTIMIZER_ENABLED
        value: "true"
      - key: AI_MODEL_TYPE
        value: "neural_network"
      - key: AI_PREDICTION_ACCURACY_PCT
        value: "87.0"
      
      # Blockchain Configuration (Set as secrets in Render dashboard)
      - key: ETH_RPC_URL
        fromSecret: ETH_RPC_URL
      - key: PILMICO_API_KEY
        fromSecret: PILMICO_API_KEY
      - key: PILMICO_PAYMASTER_URL
        value: "https://api.pilmico.io/v1/sponsor"
      - key: BUNDLER_URL
        value: "https://api.pilmico.io/v1/bundler"
      - key: WALLET_ADDRESS
        fromSecret: WALLET_ADDRESS
      - key: PROFIT_WALLET
        fromSecret: PROFIT_WALLET
      - key: PRIVATE_KEY
        fromSecret: PRIVATE_KEY
      
      # Risk Management
      - key: DAILY_LOSS_LIMIT_ETH
        value: "100.0"
      - key: MAX_DRAWDOWN_PCT
        value: "2.5"
      - key: EMERGENCY_STOP_ENABLED
        value: "true"
      - key: CIRCUIT_BREAKER_ENABLED
        value: "true"
    
    healthCheckPath: /health
    healthCheckTimeout: 30
    disk:
      name: aineon-main-disk
      sizeGB: 10
    autoDeploy: true

# ============================================================================
# GLOBAL ENVIRONMENT VARIABLES
# ============================================================================
envVars:
  - key: AINEON_ARCHITECTURE
    value: "gasless_erc_pilmico_flash_loans_three_tier_bot"
  - key: TARGET_DAILY_PROFIT_ETH
    value: "100.0"
  - key: PHASE
    value: "1"
  - key: DEPLOYMENT_STATUS
    value: "foundation_complete"
  - key: AUTO_SCALING_ENABLED
    value: "true"
  - key: HEALTH_CHECK_ENABLED
    value: "true"
  - key: PERFORMANCE_MONITORING
    value: "true"

# ============================================================================
# DEPLOYMENT CONFIGURATION
# ============================================================================
deployment:
  - strategy: "rolling"
    maxUnavailable: 1
    maxSurge: 1
    timeout: 300
    
  - healthCheck:
      enabled: true
      path: "/health"
      initialDelay: 30
      period: 10
      timeout: 5
      successThreshold: 1
      failureThreshold: 3
      
  - rollback:
      enabled: true
      automatic: true
      onFailure: true
